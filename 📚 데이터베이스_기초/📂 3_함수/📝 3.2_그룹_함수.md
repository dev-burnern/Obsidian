# 📊 그룹 함수

## 📑 목차
- [#그룹함수의 개념](#그룹함수의-개념)
- [#그룹함수의 종류](#그룹함수의-종류)
- [#GROUP BY 절](#group-by-절)
- [#HAVING 절](#having-절)
- [#GROUP BY 추가 연산자](#group-by-추가-연산자)

## 📚 그룹함수의 개념
### 🔍 이론
- **그룹 함수**: 행 집합에 작용하여 그룹당 하나의 결과를 생성
- 행 집합은 테이블 전체 혹은 WHERE 절 조건에 의해 선택된 행들이 하나의 그룹
- 그룹 함수의 결과는 항상 단일 행

- **구문**:
```sql
SELECT group_function(column), ...  
FROM table  
[ WHERE 조건(s) ];
```
## 📈 그룹함수의 종류
### 🔍 이론
- **COUNT**: 행의 개수를 반환
  - **COUNT(*)**: NULL 값이 있는 행 및 중복 행을 포함하여 행 수 반환
  - **COUNT(expr)**: 열에 NULL이 아닌 행 수 반환
  - **COUNT(DISTINCT expr)**: 중복되지 않는 NULL이 아닌 값의 수 반환

- **SUM**: 숫자 데이터의 합계 계산
- **AVG**: 숫자 데이터의 평균 계산
- **MIN**: 최소값 반환(모든 데이터 타입 가능)
- **MAX**: 최대값 반환(모든 데이터 타입 가능)

- **그룹 함수와 NULL 값**:
  - COUNT(*)를 제외한 그룹함수는 NULL 값을 제외
  - NULL 값을 포함하려면 NVL 함수 사용(예: AVG(NVL(comm, 0)))

### 💻 예제
```sql
-- 기본 그룹 함수  
SELECT SUM(salary), AVG(salary), MAX(salary), MIN(SALARY)  
FROM y_emp;

-- 날짜에 적용  
SELECT MIN(hiredate), MAX(hiredate)  
FROM y_emp;

-- COUNT 함수  
SELECT COUNT(*), COUNT(dept_id), COUNT(DISTINCT dept_id)  
FROM y_emp;

-- NULL 값 처리  
SELECT AVG(NVL(comm,0)), AVG(comm)  
FROM y_emp;
```
## 📊 GROUP BY 절
### 🔍 이론
- GROUP BY 절을 추가하여 선택된 행을 서브그룹으로 나눈 후 집계정보 산출
- GROUP BY 절에는 서브그룹의 기준 열 이름을 명시

- **구문**:
```sql
SELECT column, group_function(column), ...  
FROM table  
[ WHERE 조건(s) ]  
GROUP BY group_by_표현식  
[ORDER BY column];
```

- **사용법**:
  - FROM 절 다음에 GROUP BY 절을 명시
  - 서브그룹 생성 전에 제외할 행이 있다면 WHERE 절에 지정
  - GROUP BY 절에 지정된 열 이름만 SELECT 절에 지정 가능
  - 여러 열을 기준으로 서브그룹 생성 가능

### 💻 예제
```sql
-- 부서별 급여 합계와 평균  
SELECT dept_id, SUM(salary), AVG(salary)  
FROM y_emp  
GROUP BY dept_id;

-- 부서별, 직급별 평균급여  
SELECT dept_id, position, SUM(salary)  
FROM y_emp  
GROUP BY dept_id, position  
ORDER BY dept_id;
```

## 🔍 HAVING 절
### 🔍 이론
- HAVING 절: 그룹화된 결과를 제한하기 위해 사용
- WHERE 절은 개별 행을 제한, HAVING 절은 그룹을 제한

- **구문**:
```sql
SELECT column, group_function(column), ...  
FROM table  
[ WHERE 조건(s) ]  
GROUP BY group_by_표현식  
HAVING group_조건  
[ORDER BY column];
```